USE ROLE ACCOUNTADMIN;
USE WAREHOUSE COMPUTE_WH;

USE SCHEMA MYDB.MYSCHEMA;

//create employee table

CREATE OR REPLACE TABLE USER(
  id INTEGER,
  name VARCHAR(50),
  age INTEGER,
  state VARCHAR(50)
);

//create an storsge integration with s3 and iam role
CREATE OR REPLACE STORAGE INTEGRATION s3_int
   TYPE = EXTERNAL_STAGE
   STORAGE_PROVIDER = 'S3'
   ENABLED = TRUE
   STORAGE_AWS_ROLE_ARN =''
   STORAGE_ALLOWED_LOCATIONS = ('');

//DESCRIBE THE STORAGE INTEGRATIOM
DESC INTEGRATION s3_int;

CREATE  OR REPLACE FILE FORMAT my_csv_format
TYPE = 'CSV'
FIELD_DELIMITER =','
RECORD_DELIMITER ='\N'
SKIP_HEADER =1;

//CREATE A EXTERNAL S3 STAGE
CREATE OR REPLACE STAGE my_s3_stage
  STORAGE_INTEGRATION = s3_int
  URL = ''
  FILE_FORMAT = my_csv_format;

//ACCESS THE EXTERNAL STAGE
List @my_S3_stage;

//load data to  customer table without file format
copy int USER
FROM @my_s3_stage
FILE_FORMAT = (FORMAT_NAME = my_csv_format);

SELECT * FROM USER;


