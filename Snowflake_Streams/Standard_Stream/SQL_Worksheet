USE ROLE ACCOUNTADMIN;
USE WAREHOUSE COMPUTE_WH;

USE SCHEMA MYDB.MYSCHEMA;

//Standard Stream

CREATE OR REPLACE TABLE source_table1(
  id INT,
  name VARCHAR,
  created_date DATE
);

// Insert some records on the source table 1
INSERT INTO source_table1 VALUES
     (1,'chaos','2023-12-11'),
     (2,'Genius','2023-12-11');

//create a standard stream on the table
CREATE OR REPLACE STREAM standard_stream ON TABLE source_table1;

//select data from table
select * from source_table1;

// select data from the standard stream
select * from standard_stream;

INSERT INTO source_table1 VALUES (3,'johny','2023-12-11');

//select data from table
select * from source_table1;

// select data from the standard stream
select * from standard_stream;

DELETE from source_table1 where id=2;


//select data from table
select * from source_table1;   

// select data from the standard stream
select * from standard_stream;

//Update the source table
Update source_table1 SET name ='Elon' WHERE id=1;

//select data from table
select * from source_table1;

// select data from the standard stream
select * from standard_stream;









