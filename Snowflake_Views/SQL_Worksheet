USE ROLE ACCOUNTADMIN;
USE WAREHOUSE COMPUTE_WH;

CREATE OR REPLACE DATABASE MYDB;
CREATE OR REPLACE SCHEMA MYSCHEMA;

//create employee table

CREATE OR REPLACE TABLE employee(
  id INTEGER,
  name VARCHAR(50),
  department VARCHAR(50),
  salary INTEGER
);
//Insert data into the table
INSERT INTO employee (id,name,department,salary)
VALUES (1,'Pat Fay', 'HR', 50000),
       (2,'donald oconnel','IT',75000),
       (3,'steven king','Sales',60000),
       (4,'susan','IT',80000),
       (5,'jennifer whalen','Marketing',55000);


SELECT * FROM employee;

//STANDARD VIEW
CREATE OR REPLACE VIEW it_employee AS
SELECT id,name,salary
FROM employee
WHERE department ='IT';

SELECT * FROM it_employee;

//SECURE VIEW
CREATE OR REPLACE secure VIEW hr_employee AS
SELECT id,name,salary
FROM employee
WHERE department ='HR';

SELECT * FROM hr_employee;


//MATERIALIZED VIEW
CREATE OR REPLACE MATERIALIZED VIEW materialized_emplyee_salaries
AS SELECT
   department,
   SUM(salary) AS total_salary
FROM employee
GROUP BY department;

SELECT * FROM materialized_emplyee_salaries;








