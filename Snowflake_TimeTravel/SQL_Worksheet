USE ROLE ACCOUNTADMIN;
USE WAREHOUSE COMPUTE_WH;

USE SCHEMA MYDB.MYSCHEMA;

//---------Time Travel (Deleting some rows)-----------

CREATE OR REPLACE TABLE DROP_TABLE
(
ID INT,
NAME VARCHAR
);

INSERT INTO DROP_TABLE VALUES
(1,'JOHN'),
(2,'SAM'),
(3,'ELAN'),
(4,'MARK');

DELETE FROM DROP_TABLE WHERE ID=4;

SELECT * FROM DROP_TABLE AT(OFFSET => -60*1);

SELECT * FROM DROP_TABLE BEFORE(STATEMENT => ''::timestamp_tz  );

CREATE OR REPLACE TABLE DROP_TABLE_CLONE AS
SELECT * FROM DROP_TABLE BEFORE(STATEMENT=> '');

TRUNCATE TABLE DROP_TABLE;

INSERT INTO DROP_TABLE
SELECT * FROM DROP_TABLE_CLONE;

DROP TABLE DROP_TABLE_CLONE;

SELECT * FROM DROP_TABLE;


//-------------DROPPING TABLE. SCHEMA AND DATABASE---------

DROP TABLE DROP_TABLE;
SELECT * FROM DROP_TABLE;

UNDROP TABLE DROP_TABLE;

DROP SCHEMA MYSCHEMA;
UNDROP SCHEMA MYSCHEMA;   

DROP DATABASE MYDB;
UNDROP DATABASE MYDB;

USE SCHEMA MYDB.MYSCHEMA;
SHOW DATABASES;
SHOW SCHEMAS;
SHOW TABLES;

USE SCHEMA MYDB.MYSCHEMA;

ALTER TABLE DROP_TABLE SET DATA_RETENTION_TIME_IN_DAYS =1;




   










