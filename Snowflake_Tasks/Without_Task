USE ROLE ACCOUNTADMIN;
USE WAREHOUSE COMPUTE_WH;

USE SCHEMA MYDB.MYSCHEMA;

//---------Without Task-----------

CREATE OR REPLACE TABLE source_table(
  id INT,
  name VARCHAR,
  created_date DATE
);

// Insert some records on the source table
INSERT INTO source_table VALUES
     (1,'chaos','2023-12-11'),
     (2,'Genius','2023-12-11');

//select data from source table
select * from source_table;

//create an target table
CREATE OR REPLACE TABLE TARGET_TABLE(
      id INT,
      name VARCHAR,
      created_date DATE,
      created_day VARCHAR,
      created_month VARCHAR,
      createed_year VARCHAR
);

//INSERT INTO TARGET TABLE
INSERT INTO TARGET_TABLE
SELECT
a.id,
a.name,
a.created_date,
DAY(a.created_date) AS created_day,
MONTH(a.created_date)AS created_month,
YEAR(a.created_date) AS created_year
FROM SOURCE_TABLE A
LEFT JOIN target_table b
on a.id = b.id
where b.id is null;

//select data from target table
select * from target_table;

//insert some record into source table
INSERT INTO SOURCE_TABLE VALUES
   (3,'ELAN','2023-02-24');

   










